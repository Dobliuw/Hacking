---------------------
-  Tags: #teoria #practica #blue #basico
---------------------
# PDF
Un **Portable Document Format** es un formato de almacenamiento para documentos digitales independientes de plataformas de software o hardware.

-----
# Vulnerabilidades en PDF's
A la hora de descargar o abrir PDF's existen riesgos de quedar infectados, descargar malware terminando la misma en [[RCE - (Remote Command Execution)]] para el actor o realizar acciones que no esperabamos realizar. 

# Ataques basados en JavaScript

- ### **Ejecución de código JavaScript**: En este caso se puede embeber código malicioso JavaScript e nun PDF que puede ser ejecutado al abriri el documento, logrando, potenialmente, realizar acciones sin autorización o robo de información. 

- ### [[XSS  - ( Cross-Site Scripting )]]: En este caso, los  PDF's embebidos en JavaScript también pueden ser usuados para lanzar ataques de [[XSS  - ( Cross-Site Scripting )]] si se abren desde un navegador web, comprometiendo la seguridad e la aplicación web. 

# Links y URLs embebidos

- ### **Phishing**: Algunos PDFs pueden contener enlaces engañosos que pueden dirigir a los usuarios a falsas páginas de login o websites maliciosos, engañando para revelar información sensible.

- ### **Conducido por descargas**: PDFs que contienen links a websites malicosos pueden iniciar ataques conducidos por descargas, instalando silenciosamente malware en el sistema del usuario.

# Expoits basados en attachments

- ### **Attachment malicioso**: Los PDFs pueden incluir información adjunta que, una vez abierta, puede ejecutar código malicoso o colocar malware en el dispositivo del usuario. Los atacantes pueden tomar ventaja de las vulnerabilidades en el software lector de PDF para ganar acceso sin autorización al sistema del usuario.

# Ingeniería Social y manipulación de contenido
Los PDFS pueden ser alterados para mostrar contenido difrenciado o de marca, engañando a los usuarios para que piensen que están interactuando con un documento legítimo. Los atacantes pueden crear PDFs con firmas digitales o certificaciones falsas para aparentar confiabilidad. 


# Exfiltración de información
Información sensible dentro de un PDF, como lso envíos de formularios, puede ser extraída por un atacante si las medidas de seguridad no son las adecuadas. Los PDFs también contiene metadata que revela información acerca de la craeción y deción del documento, la cual puede ser aprovechada en ataques. 


# Exploits de día cero
Nuevas vulnerabilidades en el software de PDF pueden surgir, las cuales los atacntes pueden usar antes de que los parches adecuados estén disponibles.


# Manipulación de documento 
Los atacntes pueden modificar el contenido o la metadata del documento para crear un PDF fraudulento. Además, las discrepancias entre las versiones del PDF pueden llevar a rpoblemas de renderizado y aposibles vulnerabilidades explotables. 


# Protección por contraseña 
Los PDFs protegidos por contraseña pueden tener una débil ofácl de adivinar, haciéndolos susceptibles a acceso no autorizado.


# Formularios maliciosos
Los PDFs pueden ser manipulados para recolectar información sensible de los usuarios y ejecutar actividades maliciosas.


# Ofuscación y Esteganografía
Un atacante puede ofuscar malware dentro del contenido de un PDF, haciéndolo difícil de detectar. Las técnicas esteganográficas pueden ser usadas para escondar código o información dentro de un PDF

-----
# Análisis de PDF

## Recomendaciones y pasos para un correcto análisis de un archivo PDF

- ### **Ambiente seguro**: Realizar el análisis en un ambiente controlado e isolado para prevenir el potencial esparcimiento del malware. Usar una máquina virtual o un sistema dedicado para evitar contaminar el dispositivo de trabajo primario.
- ### **PDF Viewer/Editor**: Comenzar por abrir el PDF con un software con buena reputación para inspeccionar visualmente el documento buscando contenido sospechoso, links, adjuntos o JavaScript.
- ### **Escaneo anti malware**: Usar antivirus y anti-malware para escanear el archivo PDF para buscar firmas de malware conocido.

## Herramientas de análisis de PDF

- ### **PDF Stream Dumper (pdf-parser)**: Un script de python para analizar PDFs, extraer JavaScript y analizar la estructura de los objetos.
- ### **peepdf**: Herramienta de Python para análisis que incluye extracción de objetos, JavaScript y streams embebidos.
- ### **Didier Stevens Suite**: Colección de herramientas de Didier Stevens que incluyen herramientas de análisis de PDF.
- ### **PDFiD**: Es una herramienta para identificar PDFs con características maliciosas, como JavaScript o archivos embebidos.

## Otros Análisis

- ### **Análisis de JavaScript**: Extraer y analizar código de JavaScript del PDF usando herramientas de análisis como las que vimos. Buscar código sospechoso u ofuscado.
- ### **Análisis de Strings**: Se puede usar el comando “string” (u otra utilidad similar) para extraer strings de texto plano desde el PDF. Esto puede revelar información oculta.
- ### **Inspección de Metadata**: Examinar la metadata del documento buscando información inusual o sospechosa, como la autoría, fecha de creación o revisión de historial.
- ### **Análisis estático y dinámico**: Considerar el uso de SandBox o ambientes virtuales para realizar un análisis dinámico del PDF, así como ejecutarlo allí para observar el comportamiento del archivo.
- ### **Análisis de Red (si aplica)**: Si el PDF contiene links o se comunica con servers externos, usar herramientas de Network Monitoring para inspeccionar el tráfico en busca de actividad sospechosa.
- ### **Comparación de Hash y archivo**: Calcular el hash (ej: MD5, SHA256) del PDF antes y después del análisis para asegurarse de que la integridad del mismo no fue comprometida durante el análisis.