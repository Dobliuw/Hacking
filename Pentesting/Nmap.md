--- 

# Nmap y modos de escaneo: 

### Con el comando `route -n` podemos ver la dirección ip de nuestro router, en el apartado de Gateway.

```shell
# Abrir manual de nmap.
man nmap 

# Escanear todos los rangos de puertos
nmap -p1-65535 {to_scan_ip}
namp -p- {to_scan_ip}

# Escanear los 500 puertos más comunes
nmap --top-ports 500 {to_scan_ip}

# Filtrar solo por aquellos puertos que esten abiertos, ignorando puerots filtrados. 
nmap -p- --open {to_scan_ip}

# Verbose para listar a medida que se vayan detectando puertos abiertos, los vaya reportando en tiempo de ejecución. 
nmap -p- --open -v {to_scan_ip}

# Quitar resolución DNS
nmap -p- --open -v -n {to_scan_ip}

# Seleccionar la plantilla de temporizado para agilizar el escaneo
nmap -p- -T5 --open -v -n {to_scan_ip}

# Tirar de TCP Connect Scan para intentar establecer conexión con el Three-Way Handshake, es decir tramitar un paquete SYN, para recibir o un paquete (RST -> closed) o un paquete (SYN/ACK -> open) para posteriormente establecer la conexión con un paquete ACK (established)
nmap -p- -T5 --open -sT -v -n {to_scan_ip} 

# Quitar el "HOST DISCOVERY" 
nmap -p- -T5 --open -sT -v -n -Pn {to_scan_ip}

# Para escanear los rangos de UDP
namp -p- --open -sU -v -n -Pn {to_scan_ip}

# Asi como con arp-scan -I eth0 --localnet, podemos ver los hosts que tenemos activos en nuestra red. Con nmap tambien 
nmap -sn {our_ip}/{cidr} 

# Tratar de detectar el sistema operativo
nmap -O {to_scan_ip}

# Tratar de detectar versión y servicios que corre para ciertos puertos
nmap -p22,80 -sCV {to_scan_ip}
```