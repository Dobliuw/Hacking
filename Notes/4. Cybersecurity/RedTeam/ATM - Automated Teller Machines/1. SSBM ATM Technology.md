# Implementation SSBM ATM Cycle

A continuación se describe el **lifecycle** de una máquina de auto servicio bancaria (**SSBM ATM**).

![[Pasted image 20251001144540.png]]

1. **Adquisition**: Definición de *requerimientos operativos, físicos y lógicos* de arquitectura de Infraestructura y nodos de servicio ATM. Se decide el hardware, periféricos (Dispense, PIN pad/EPP, card reader, camara), OS, telemetría, HSM/SAM, conectividad y SLAs con proveedores.

2. **Certification**: *Validación técnica* y *de seguridad* de lo adquirido: pruebas de integración, validación de configuraciones, verificación de firmas/firmware, pruebas funcionales y de interoperabilidad con switch bacnario y HSM.

3. **Impementation**: Implementación y *puesta en marcha de Infraestructura* y *nodos de servicio ATM* en sitios. Es decir, despliege *físico* y *lógico* en el sitio: instalación configuración enrolamiento en gestión centralizada, provisioning de claves, tests post-deploy y baseline inicial.

4. **Operation and Maintenance**: *Operación transaccional* y *de seguridad* día a día de Infraestructura y nodos de servicio ATM. Transacciones, back-office, parches, gestión remota, revisión de logs, monitoreo de salud, reabastecimiento de efectivo y mantenimientos físicos.

	41. **Incident Response**: Proceso de *validación*, *respuesta*, *recuperación* y *normalización operativa* ante materialización de incidente en canal ATM. (Fraudes, jackpotting, tampering, compromiso de firmware, leak de claves).

5. **Provision**: *Destruccuión* y/o *sanitización segura* de componentes de Infraestructura y nodos de servicio ATM. End-of-line: retiro, desisntaación sanitisación/destrucción segura de componentes (Discos, HSMs, backups, lllaves) y actualización de inventario.

----
# General SSBM ATM Infraestructure 

En a imagen a continuación podemos observar el *flujo de una transacción ATM* y cómo se conecta el *Nodo de autoservicio* (*ATM* Físico) con la infraestructura del banco/proveedor y, finamente, con adquirientes, switches y emisores/servicios de teceros (Visa/Mastercard/Issuer).

![[Pasted image 20251001145250.png]]

Las zonas principales demostradas en este gráfico son, de izquierda a derecha, las siguientes:

1. **Nodo de autoservicio** (**ATM** Físico): Hardware y Software local.
2. **Enlace de comunicación con back-end ATM**: WAN/cellular/VPN y protocolos de mensajería (Transaccional).
3. **Perímetro** / **Concentrador de enlaces**: Firewalls, VPN concentrators, IDS/IPS, NAT/Proxies.
4. **Adquiriente** / **Switch intermedio**: Switch del banco o procesador que enruta la transacción.
5. **Emisor** / **Servicios externos**: Redes de pago y bancos emisores.
###### SSBM ATM Node

Este dispositivo contiene su **OS** (*Windows Embedded* o *Linux Embedded*), **aplicación ATM** / **UI**, **middleware XFS** o **API de periféricos**, **PIN pad** (*EPP* - *Encryption PIN Pad*), **card reader**, **cash dispenser**, **receipt printer**, **cámaras**, **sensores físicos**, **módulo SAM**/**HSM** O conexión remota a HSM (*HSM* - *Hardware Security Module*).

Algunos de los *protocolos*/*estándares* relevantes en este punto son:

- *EMV* (Chip cards).
- *DUKPT* / *EEP* (Para cifrado de PIN).
- *ISO 8583* o *NDC* (Para mensajes transaccionales).
- *XFS* (Para interfaz de periféricos).

Riesgos:

- **Acceso físico** (Skimming, shimming, manipulación de carcasa).
- **Malware**/**Jackpotting** (Malware en la app SO o carga maliciosa por USB).
- **PIN compromise** (Si *EPP*/*HSM* está mal configurado).
- **Firmware**/**UEFI tampered** o **arranques desde USB**.
- **Puertos abiertos** (USB/Serial) y **configuraciones por defecto**.

###### Communication Link with ATM Back-End

Es el canal (WAN, 4G/5G, Fibra) que transporta mensajes entre el ATM y el backend (Concentrador o Switch). Suele llevar mensajes *ISO8583*, con encapsulación *TLS*/*VPN* o protocolos propietarios.

Riestos:

- **Intercepción de tráfico** (*MiTM*) si la encriptación o autenticación es débil.
- **Reenvío** / **relay** de paquetes (*Replay*) si no hay protecciones de mensajes.
- **Uso de redes públicas** (*Cellular*) sin segmentación o VPN fuerte.

En relación con el artículo [[Ambiguous Techniques]], en este punto ataques de *relay*/*replay* podrían parecer retransmisiones perdiddas/retries y vicebersa; reinicios de enlace pueden ser mantenimiento legítimo o manipulación.

###### Perimeter / Link Concentrator

Esto suele contener firewalls, NAT, concentradores VPN, IDS/IPS, proxies que agregan muchas conexiones ATM y las encaminan al switch interno.

Riesgos:

- **Compromiso del concentrador** (Punto único de fallo) permitiría envenenar múltiples ATMs.
- **Reglas mal aplicadas** que permiten acceso no esperado (RMM Expuesto).
- **Fata de visibilidad** / **Logging insuficiente** en el concentrador.

###### Purcharser / Intermediate Switch

Recibe mensajes, aplica reglas de negocio, enruta a emisores, puede aplicar límites/fraude, comunica con HSM para verificación de PIN, etc.

Riesgos:

- **Credenciales de interconexión robadas**.
- **Fallos de aislamiento multitenant** en procesadores que manejan varios bancos.
- **Vulnerabilidades en el Switch** que permiten alterar respuetas (Autorizaciones.)


