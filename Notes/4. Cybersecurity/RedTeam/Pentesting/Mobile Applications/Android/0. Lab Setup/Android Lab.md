# Android Lab

Deberemos llevar a cabo la instalación de algunas herramientas para conseguir tener un laboratorio personale el cual nos permite llevar a cabo análizis estáticos y dinámicos en softwares móviles para Android.

---
# Java
##### Windows
Lo primero que deberemos hacer es instalar [Java](https://www.java.com/en/).
##### Linux
*Automatización*: Para sistemas Kali Linux podríamos hacer uso de la herramienta [pimpmykali](https://github.com/Dewalt-arch/pimpmykali), desarrollada por un usuario de la plataforma TCM Security, la cual nos permitiría hacer uso de un scritp el cual automatize la instalación de todas las herramientas necesarias. (En caso de hacer uso de este script ignorar la instalación manual de cada herramienta encontrada abajo).

En caso de no contar con Java en Windows, podríamos seguir la [guía de instalación](https://www.java.com/en/download/help/linux_x64_install.html) para descargar e instalar Java.

```bash
# Updatae
sudo apt-get update
# Install Java Development Kit
sudo apt-get install default-jdk -y
```

----
# Jadx

[JADX](https://github.com/skylot/jadx) es una herramienta de código abierto que nos permite decompilar el código de Android Dex y archivos APK. Esta herramienta cuenta con utilidades de línea de comandos y GUI.
##### Windows
Para llevar a cabo la descarga de la misma deberemos visitar la [página de los releases](https://github.com/skylot/jadx/releases/tag/v1.5.0) y descargar el instalador *.exe* correspondiente a nuestra arquitectura.
##### Linux
Para descargar `jadx` en linux podríamos hacer uso de los comandos:

```bash
# Update
sudo apt-get update
# Install jdx
sudo apt-get install jadx
```

Podríamos hacer uso de `jadx` para hacer uso de CLI o `jadx-gui` para hacer uso de la GUI.

---
# [SKD Platform-Tools](https://developer.android.com/tools/releases/platform-tools)

Las *SDK Platoform-Tools* son un conjunto de utilidades esenciales incluidas en el **SDK** (**Software Development Kit**) de Android, que permiten a los desarrolladores interactuar con el dispostivio Android durante el desarrollo, prueba y despliegue de aplicaciones. Entre las herramientas más imporatantes en este conjunto se encuentra `adb` (*Android Debug Bridge*) y `fastboot`. 

`adb` es una herramienta versátil que permite a los desarrolladores comunicarse con un dispositivo Android desde su equipo. Las funcionalidades principales de esta son:

- **Connection and Communication**: Permite conectar y comunicarse con un dispostivo Android conectado por USB o mediante una conexión de red.
- **Installing the application**: Permite instalar (`adb install`) y desisntalar (`adb uninstall`) aplicaciones en el dispositivo.
- **Debuggin and Logcat**: Permite depurar aplicaciones en tiempo real y obtener registros de eventos del sistema (`adb logcat`).
- **File system Access**: Permote copiar archivos entre el dispostivio y el equipo (`adb push` y `adb pull`).
- **Command Execution**: Permite ejecutar comandos de shell en el dispositivo (`adb shell`), proporcionando acceso directo al sistema operativo Android.
- **Device Restart**: Permite reiniciar el dispositivo en diferentes modos, como recovery o bootloader (`adb reboot`).

```bash
# List all connected devices
adb devices
# Install an app in the device
adb install {myapp.apk}
# Show events logs from the system
adb logcat
# Display a Shell in the device
adb shell
```

`fastboot` por otro lado, es una herramienta que permite interactuar con el bootloader del dispositivo Android. Es particularmente útil para tareas de recuperación y actualización del firmware del dispositivo. Las funcionalidades principales de `fastboot` incluyen:

- **Image Flashing**: Permite flashear distintas particiones del dispositivo (boot, recovery, system) con imágenes de firmware.
- **Bootloader Unblocking**: Permite desbloquear y bloquear el bootloader del dispositivo, lo cual es necesario para flashear imágenes personalizadas.
- **Reboot in specific modes**: Permite reiniciar el dispositivo en modo bootloader o en modo de recuperación.

```bash
# Dispay the devices with fastboot mode
fastboot device
# Unblock bootloader
fastbook oem unblock
# Flashing a new recovery image
fastboot flash recovery {recovery.img}
# Reboot the device
fastboot reboot
```
##### Windows download
Nos dirigimos a la página web de [developer.android](https://developer.android.com/tools/releases/platform-tools) y seleccionamos la opción de **Download SDK Platform-Tools for Windows**. Esto nos descargará un zip el cual una vez extraido nos dejará una carpeta con las herramientas deseadas, para poder correr estas desde la terminal será necesario agregar esta carpeta dentro de una carpeta perteneciente a la variable de entorno `PATH`. 

Para modificar la variable de entorno `PATH` para ingresar esta carpeta una vez movida a una nueva ruta deseada podríamos hacer uso de la GUI ingresando *Edit environment variables for your account* y *Editando* la variable de entorno `PATH`, agregando una nueva ruta hacia la carpeta descargada una vez movida a la ruta que deseemos, o desde la CLI con los siguientes comandos:

`cmd.exe`
```bash
# Syntaxis
setx {var_name} "{value}"
# Adding a new route at the end of the var PATH
setx PATH "%PATH%;C:\New\Route"
# Adding a new route at the beginning of the var PATH
setx PATH "C:\New\Route;%PATH%"
```

`powershell.exe`
```powershell
> $env:Path += ";C\New\Route"
> [Environment]::SetEnvironmentVariable("Path", $env:Path, [EnvironmentVariableTarget]::Machine)
```

Es importante tener en cuenta que se necesitará cerrar la ventanas y volverlas a abrir para aplicar los cambios de las variables de entornos, pero podríamos hacer uso de scripts como [refreshenv](https://pastebin.com/1fJqA0pT) para guardarlos en el sistema y poder tener una utilidad para refrescar las variables de entorno y que esto no sea necesario. 
##### Linux
Para descargar `adb` en Kali Linux es bastante sencillo, lo único que deberíamos hacer es ejecutar el comando:

```bash
# Update
sudo apt-get update
# Install adb
sudo apt-get install adb 
```
----
# [Apktool](https://apktool.org/)

*Apktool* es una herramienta de ingeniería inversa para archivos APK. [Repositorio oficial](https://github.com/iBotPeaches/Apktool?tab=readme-ov-file) y [Guía de installación](https://apktool.org/docs/install)
##### Windows
Nos dirigimos al sitio oficial de descarga de [apktool](https://apktool.org/) y presionamos el boton de *Download x.x.x*. 
##### Linux
Para descargar `apktool` en Kali Linux, simplemente deberiamos ejecutar los comandos:

```bash
# Update
sudo apt-get update
# Install apktool
sudo apt-get install apktool
```

En caso de correr el comando `apktool` y ver la versión *2.6.1-dirty* podríamos actualizar apktool a la última versión usando este [link]([https://ibotpeaches.github.io/Apktool/](https://ibotpeaches.github.io/Apktool)).

----
# [Android Studio](https://developer.android.com/studio)

Android Studio es el entorno de de sarrollo integrado (IDE) oficial para el desarrollo de aplicaciones Android, este proporciona un conjunto completo de herramientas para el desarrollo, depuración, prueba y despliegue de aplicaciones Android.
##### Windows
Nos dirigimos a la [página oficial de descarga](https://developer.android.com/studio) y seguimos el proceso instalación de cualquier software que descarguemos.
##### Linux
*Importante*: En caso de estar haciendo uso de una VM evitar la instalación, dado que si intentamos instalar esto e intentamos emular podremos tener porblemas y crasheos en la aplicación de virtualización. Seguir el procedimiento de descarga si estamos haciendo uso de una máquina linux.

En este caso nos dirigimos a la [página oficial de descarga](https://developer.android.com/studio), descargamos el archivo *tar.gz*, lo descomprimimos con `tar -xgzf {android_studio_download.tar.gz}`, esto nos dejará una carpeta que contrendrá un subdirectorio llamada *bin* con un archivo **studio.sh** el cual podremós ejecutar.

