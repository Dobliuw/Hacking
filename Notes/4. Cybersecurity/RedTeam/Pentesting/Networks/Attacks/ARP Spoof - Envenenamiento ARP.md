-----
- Tags: #teoria #practica #redes #ataques 
----
# ARP Spoofing | Envenenamiento ARP

El *ARP Spoofing* es una técninca de ataque en redes donde un tacante envía mensajes ARP falsificados en una red local. Esto se hace para asociar la dirección MAC del atacante con la dirección IP de otro dispositivo, como un servidor o un gateway, lo que permite al atacante interceptar el tráfico entre dos sistemas.

El concepto de *Man-In-The-Middle* (*MITM*) es crucial en esta técnica, ya que el atacante se posiciona estratégicamente entre dos partes para interceptar o modificar el tráfico de datos, una táctica común en ataques cibernéticos. Esta técnica es posible debido a la naturaleza de confianza del protocolo ARP, que no verifica si las respuestas sa las solicitudes ARP son legítimas.

- Ejempo de conexión normal en una LAN:

![[lan_connection_arp.png]]

- Ejemplo de una conexión con ARP Spoofing en una LAN:

![[arp_spoofing_example.png]]

----
# Ataque

Para llevar acabo este ataque lo primero que deberíamos realizar es ciertos cambios a nivel de sistema, como a nivel de *Firewall*, cambiando las politicas para el *FORWARD*.

- En caso de usar iptables:
```bash
sudo iptables --policy FORWARD ACCEPT
```

Por otro lado, cambiar el valor del archivo */proc/sys/net/ipv4/ip_forward* a **1**:

```bash
sudo echo 1 > /proc/sys/net/ipv4/ip_forward
```

Con estas configuraciones realizadas, estaríamos con la posibilidad de comenzar a envenenar la red para cambiar el valor de las tablas arp (**arp -a**) del *gateway* como de la máquina *victima*. Para ello podríamos hacer uso de herramientas como *arpspoof* o crearnos nuestro propio envenenador en legunajes como python y librerías como *Scapy*. 

```bash
arpspoof -i {network_interface} -r {gateway_ip} -t {target_ip}
```

