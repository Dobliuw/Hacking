# Deautentication Attack

El ataque de deautenticación es un tipo de ataque de denegación de servicio (*DoS*) en redes inalámbricas, donde se envían *paquetes de deautenticación* a un *cliente* conectado a un punto de acceso (*AP*), forzando su desconexión para capturar *handshakes*. Este ataque es útil para capturar handshakes de redes WPA/WPA2 o interrumpir conexiones de red.

Un **handshake** en redes Wi-Fi es un proceso de aunteticación y negociación que se lleva a cabo entre un cliente y un AP cuando el cliente intenta conectarse a la red. En el contexto de redes WPA/WPA2, el *4-way handshake* es un proceso de cuatro pasos que asegura que tanto el cliente como el AP tienen la misma **clave precompartida** (**PSK** - **Pre Shared Key**)  y negocian una clave temporal para cifrar el tráfico de la sesión.

El **4-way handshake** en WPA/WPA2 se realiza en los siguientes pasos:

1. El AP envía un *nonce* (Número aleatorio) al cliente.
2. El cliente genera su propio nonce y lo venía al AP junto con una vesión cifrada del nonce del AP usando la PSK.
3. El AP verfica la información recibida, genera una clave temporal (PTK) y la envía cifrada al cliente.
4. El cliente configra la recepción de la clave temporal (PTK) y la conexión se establece

Por lo que la idea de este ataque, es poder deautenticar a clientes de un AP forzando su reconexión para captura el handshake el cual contiene la contraseña cifrada de la víctima y así, posteriormente y de manera offline, poder intentar crackear y descifrar la misma.

Representación visual de este ataque: [[DEAUTHENTICATION_ATTACK_draw].]

-----
# Exploit

Como vimos en la fase de [[0. Hacking WiFi#Pre-Explotación]], es necesario llevar a cabo ciertas configuraciones previas para poner nuestra interfaz en modo monitor, matar ciertos procesos, etc. Una vez realizado esto, haciendo uso de la herramienta `aireplay-ng` podremos llevar acabo distintos tipos de ataques, entre ellos, el ataque de deautenticación.

- Emitir una determinada cantidad de paquetes de deautenticación a un cliente conectado al AP víctima hasta que usemos *Ctrl + C*
```bash
sudo aireplay-ng -0 {packages_to_send} -e {ssid_name} -c {client_mac} {interface}
```

Luego de capturar el handshake, para válidar que el mismo fue capturado correctamente, podríamos hacer uso de `aircrack-ng`.

```bash
sudo aricrack-ng {capture}.cap
```

Donde deberiamos buscar el mensaje `[ WPA handshake: <BSSID> ]` para confirmar la captura exitosa del mismo.