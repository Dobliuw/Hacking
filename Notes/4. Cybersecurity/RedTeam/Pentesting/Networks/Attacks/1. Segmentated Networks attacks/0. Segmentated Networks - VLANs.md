# Segmentated Networks

Muchas organizaciones, por lo general la mayoría, intentea mejorar la seguridad de sus redes a través de la implementación de segmentación de redes o estrategias de segregación. Estas estrategias separan activos con menor requerimiento de seguridad, como dispositivos en la red de inivitados, de componentes criticios de la infraestructura de la empresa, como los servidores web localizados en un datacenter y la red para telefonos celulares de los empleados.

---
# VLANs (Virtual Local Area Networks)

Una *VLAN* es una red lógica que agrupa un conjunto de dispositivos en una o más redes físicas, separando el tráfico de red en diferentes segmentos para mejorar la seguridad y la eficiencia de la misma, estas permiten que dispositivos qeu están físciamente en la misma red, pero lógicamente separados, no puedan comunicarse directamente sin pasar por un router o firewall. 

Para que dispositivos en diferentes VLANs se comuniquen, el tráfico debe pasar por un dispositivo de *Capa 3* (*Network*) del [[Modelo OSI - OSI Model]], como podría ser un router o switch. Estos dispositivos serán capaces de entender y enrutar tráfico entre distintas subredes, así como también podrán aplicar **ACLs** (**Access Control LIsts**), que son reglas qeu determinarán si un paquete de datos puede pasar o debe ser bloqueado.

En relación a *IoT*, estas pueden segmentar dispositivos sensibles, aislando el tráfico dpara evitar accesos no autorizados.

Si las *VLANs* están configuradas de forma isneguroa o si se utilizan protocolos de red vulnerables, un atacante podría aprvoechar estas debilidades para realizar un ataque de **VLAN-Hopping**. Este tipo de a t aque permite que el atacante acceda a tráfico de una VLAN diferente a la que originalmente tiene acceso, eludiendo las segmentaciones de seguridad.

![[common_vlan_network.png|1200]]

###### Access ports

En un switch, los *puertos de acceso* (*access ports*) se configuran para pertenecer a una VLAN específica, por ejemplo, si el puerto 1 del switc está asginado a la VLAN 10, cualquier tráfico que llegue a este puerto será etiquetado como perteneciente a la VLAN 10.

Cuando un dispositivo conectado a un puerto de acceso envía un paquete, el swtich añade un identificador de VLAN (*VLAN ID*) al paquete, si es necesario. Este ID se utiliza internamente por el switch para saber a qué VLAN pertenece el tráfico y para decidir a qué otros puertos reenviar el tráfico. (Solo envía a los puertos configurados para esa VLAN). Lo que permite que aunque el switch tenga muchos puertos, el tráfico de una VLAN específica solo se distribuye entro los dispositivos  dentro de esa misma VLAN.

###### Trunk Links & VLAN Tagging

Cuando el tráfico necesita pasar entre switches, esto se realiza a través de un *trunk link*, donde el switch añade un *VLAN tag* al pquete que incluye el *VLAN ID*. Este proceso se conoce como *VLAN Tagging*, una vez que el tráfico llega al switch de destino, el VLAN tag es eliminado y el tráfico se dirige a los puertos correctos basados en la VLAN original a la que pertenece el paquete.

###### Tráfic flow

Como vimos en la imagen de arriba, si un dispositvo (Ejemplo, *Guest laptop* de la *Room A*) envía un paquete, ese paquete solo puede ser enviado a otros dispositiovs en la VLAN a la que pertenece este (Ejemplo, *VLAN 10*), ya sea dentor del mismo switch o a través de un trunk link a otro switch.

Por otro lado, para que el tráfico puede moverse entre diferentes VLANs, el tráfico debe pasar a través de un dispositivo de capa 3 (Como un router o un switch de capa 3) que tenga reglas configuradas para permitir o denegar dicho tráfico.

