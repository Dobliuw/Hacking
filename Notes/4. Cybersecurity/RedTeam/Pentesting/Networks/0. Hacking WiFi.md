-----
- Tags: #teoria #practica #redes #ataques 
----
# Tarjetas de Red 

Para poder llevar a cabo un ataque de **WiFi** es importante contar con una tarjeta de red. Una **tarjeta de red** es un componente de **hardware** que conecta un ordenador a una red y que posibilita compartir recursos en una red de computadoras. 

- ### La computadora suele traer una y si estamos en una distribución de **linux** y con la misma en un Sistema Operativo base, podriamos utilizar dichar tarjeta de red siempre y cuando acepte el **modo monitor**

- ### En caso de que dicha tarjeta no acepte modo monitor necesitaremos una **tajeta de red** o **adaptador WiFi** con la funcionalidad de **modo monitor**. 

El **modo monitor** es un modo que permite hacer uso de la **Tarjeta WiFi** en modo de escucha o modo promiscuo de **datos**. En este modo la tarjeta es capaz de capturar todos los tipos de paquetes tramitados en una red WiFi.

Al conectar una **tarjeta de red** se creara una nueva **interfaz**, mediante la cual nos podriamos comunicar con la misma

----
# Interfacez de Red

Una interfaz de red es el software que se comunica con el dispositivo que nos brinda internet y la capa **IP** a fin de proporcionar a la capa IP una interfaz coherente con todos los adaptadores de red que puedan estar presentes.

```shell
# Listar interfacez de red 
ifconfig
# Listar interfacez de red que no esten activas, que esten dadas de bajas, etc.
iwconfig
```

----
# Direcciones IP 

Como vimos en [[Basic Concepts]], las direcciones **IP** son identificadores númericos para **identificar** dispositivos en una **red**.  Es importante agregar que dichas **IP** pueden ser bien **PRIVADAS** o **PUBLICAS**.

- ## IP Privada
La ip privada es la ip que se asigna dentro del entorno de **red local**, por lo que si alguien por ejemplo nos lanzase una traza icmp, nuestra maquina no responderia ya que es la ip que utiliza para el segmento de red privada.

- ## IP Pública
En cambio la ip publica es con la ip que **salimos** a **internet**, la cual debemos cuidar para que no sea obtenida por nadie.

```shell
# Ver mis ips privadas
hostname -I 
# Ver mi ip publica 
curl https://ipinfo.io 
```

----
# Direcciones MAC 

Concepto tambien explicado en [[Basic Concepts]], pero en este caso, entrando con lo que es la explotación es importante saber cambiar la dirección **MAC** ya que es el identificador, por lo que todo tráfico en la red registrara esta dirección **MAC** nuestra, por lo que es el primer paso necesario para llevar acabo cualquier tipo de ataque. 

```shell
# Ver la dirección mac de mi tarjeta de red 
macchanger -s {interfaz}
# Ver los OUI's (Explicado en Conceptos Basicos)
macchanger -l 
# Una vez seleccionado un OUI, solo queda cambiar la MAC haciendo uso de uno y pudiendo modificar el NIC a gusto tambien 
macchanger --mac=FF:FF:FF:FF:FF:FF {interfaz}
```

----
# Handshake 

Cuando un dispositivo se conecta a una red WIFi es produce lo que se conoce como **handshake** entre el **AP** (Access Point) y el **dispositivo**. Esto se hacer para verificar que las **credenciales** que se proporcionan en este momento coincidan entre si, tanto las del **AP** con las del **dispositivo**, por lo que las **credenciales viajan cifradas** por los paquetes en este momento. 

----
# Pre-Explotación 

- ## Inicializar el modo monitor 

Como vamos a manipular el modo en el que opera actualmente nuestra interfaz, es necesario suspender la interfaz para realizar los cambios y configuraciones necesarias, en este punto lo quen os intereza es realizar el cambio a **modo monitor** así tambien como realizar el **cambio de la MAC**. 

Para realizar la mayoria de los ataques que más adelante vamos a ver, utilizaremos una **Suite de software**, que es un paquete de archivos y aplicaciones, llamada **Aircrack** la cual consiste en un conjunto de herramientas que sirven para hacer funcionar a esta como un analizador de paquetes de redes y auditoria inalámbrica. 

```shell
# Suspender una interfaz / Reactivar la interfaz 
ifconfig {interfaz} down / ifconfig {interfaz} up 
# Volver a ver el estado de nuestra interfaz 
iwconfig
# Inicializar el modo monitor con la suite de aircrack / suspender modo monitor
airmon-ng start {interfaz} / airmon-ng stop {interfaz}
```

Algo importante a remarcar, es que a la hora de inicializar el **modo monitor** hay que tener en cuenta que ciertos **procesos** quedan **corriendo** los cuales podrian traer ciertos **problemas** en ataques a realizar, por lo que se deben matar dichos procesos (A la hora de inicializar el modo monitor estos procesos salen en el **stdout** y se recomienda matarlos )

```shell
# Cualquiera de las tres maneras sirven para matar estos procesos (dhclient y wpa_supplicant)
pkill {name_process} && pkill {name_process}
killall {name_process} {name_process}
airmon-ng check kill 
```

Y algo a recordar es que cuando **paremos** el **modo monitor** se recomienda **reiniciar** el servicio de **networking**. Este servicio es un software que permite que el sistema operativo pueda comunicarse con diferentes redes, ya sean cableadas o inalámbricas. Este servicio es responsable de administrar los recursos de red del sistema, como la configuración IP, la configuración de la interfaz de red, el enrutamiento y la resolución de nombres. 

```shell
# Opciones de restartear el servicio de networking
/etc/init.d/networking restart 
service networking restart 
```

- ## Dumpeo del tráfico de red 

Para poder iniciar un ataque de red se debe tener un objetivo, pero previo a esto debemos saber ciertas cuestiones como el **canal**, la **essid** o el **bssid**, entre otras cosas de la red para poder dirigir el ataque hacia una sola red. 

A continuación se listan los valores que seran representados a la hora de dumpear el tráfico de una o varias redes.:

- #### **BSSID**:  MAC del AP (Access Point) o Router. 
- #### **PWR**: Power de la red. 
- #### **\#Data**: Data de la red. 
- #### **\#/s**: Por segundo. 
- #### **CH**: Canal en el que escucha la red. 
- #### **MB**: MegaBytes. 
- #### **ENC**: Encriptado. 
- #### **CIPHER**: Parte del cífrado. 
- #### **AUTH**: Clave de autorización. 
- #### **ESSID**: Nombre de la red 

Ejemplo de un dumpeo de red: 

![[dumpeo_de_trafico.png]]

Otra cosa importante, es la parte inferior donde se muestra **STATION**, hace referencia a los **dispositivos** que se logran analizar junto a la red que estan conectados (**BSSID**). 

Ahora si, toca dumpear el tráfico de la red y posteriormente comenzar a filtrar por canales, bssid, essid, etc. y para realizar dichas acciones tenemos varios comandos: 

```shell 
# Dumpear todo el tráfico de red.
airodump-ng {interfaz}
# Dumpear todo el tráfico de red para un canal. 
airodump-ng -c {channel} {interfaz}
# Dumpear todo el tráfico de red para una red en particular
airodump-ng -c {channel} --essid {essid} {interfaz}
airodump-ng -c {channel} --bssid {bssid} {interfaz}
```

Ahora bien, para hackear una red inalambrica, necesitamos ir guardando todo el tráfico en un archivo para poder capturar la contraseña ya que esta no va a estar en texto claro, si no, cifrada con el **CIPHER** que tenga, posteriormente necesitariamos extraer el hash de la clave cifrada para aplicar fuerza bruta, por lo tanto,  para capturar dicho tráfico en un archivo se utiliza el sig. comando: 

```shell 
# Escaneando una red en particular haciendo uso del essi o bssid, necesitamos agregar el -w para dumpear todo el trafico en un arhcivo.
ariodump-ng -c {channel} --essid/--bssid {essid/bssid} -w {file_name} {interfaz}
```

----
# Explotación 

Es importante entender, que el objetivo de todos los ataques termian siendo conseguir el **handshake**, para realizar esto existen varios tipos de ataques. 

Flujo de conexión habitual [[WiFiConnections_draw]].


