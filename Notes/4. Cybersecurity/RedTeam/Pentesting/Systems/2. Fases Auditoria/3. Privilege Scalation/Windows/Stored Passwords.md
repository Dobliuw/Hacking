# Privesc by Stored Passwords

Como pentesters sabemos que la búsqueda de credenciales hardcodeadas o almacenadas en archivos es una actividad la cual realizamos con la esperanza de encontrar estas, las cuales podrían ser reutilizadas en distintas aplicaciones, servicios o en el mejor de los casos, como contraseña de Administrador o un usuario privilegiado. En este caso puede ser muy buena idea buscar este tipo de eventos en el [[0. Windows Basics#Windows Registry]] previo a realizar una búsqueda exhausta en todos los discos.
 
```powershell
# VNC (Virtual Network Computing)
> reg query "HCKU\Software\ORL\WinVNC3\Password"
# Windows Autologin
> reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"
# SNMP Parameters (Simple Network Manager Protocol)
> reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP"
# PuTTY (SSH & Telnet free client for Windows)
> reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"
# Search for password in registry
> reg query HKLM /f password /t REG_SZ /s
> reg query HKCU /f password /t REG_SZ /s
```

Tras la búsqueda en el Registro de Windows, en caso de no encontrar nada, sería interesante realizar este tipo de búsquedas en todo el disco, lo cual llevará un tiempo de espera bastante alto.

```powershell
# Find all passwords in those files
> findstr /si password *.txt
> findstr /si password *.xml
> findstr /si password *.ini
# Find all those strings in config files
> dir /s *pass* == *cred* == *vnc* == *.config*
# Find all passwords in all files
> findstr /spin "password" *.*
```