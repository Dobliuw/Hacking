# PSCredential

El objeto **PSCredential** de PowerShell es una clase fundamental utilizada para almacenar y manejar de manera segura credenciales. Es parte del *namespace* **System.Management.Automation** y está diseñado específicamente para guardar un nombre de usuario y una contraseña de manera segura. La contraseña dentro del objeto PSCredential esta almacenada como *SecureString*, lo que significa que esta encriptada en memoria y puede ser utilizada de manera segura a través de diferentes functiones y comandos (cmdlets) que requieran autenticación.
###### Creating a PSCredential Object

- Creando la contraseña en *SecureString*  y construyendo el objeto *PSCredential*:
```powershell
> $username = "dobliuw"
> $password = ConvertTo-SecureString "dobliuw123" -AsPlainText -Force
> $credential = New-Object System.Management.Automation.PSCredential($username, $password)
```
###### Storing PSCredential Objects

- Exportar el objeto *PSCredential* a un archivo *.xml*:
```powershell
> $credential | Export-Clixml -Path C:\Path\To\credentials.xml
```

- Contenido del archivo *.xml* exportado:
```xml
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04">
  <Obj RefId="0">
    <TN RefId="0">
      <T>System.Management.Automation.PSCredential</T>
      <T>System.Object</T>
    </TN>
    <ToString>System.Management.Automation.PSCredential</ToString>
    <Props>
      <S N="UserName">dobliuw</S>
      <SS N="Password">01000000d08c9ddf0115d1118c7a00c04fc297eb010000004004689635c6234d8b3d8c6dd0d5208800000000020000000000106600000001000020000000678d350bf4cbf597d93b823b4574eea53b6809ccd5b68725fff3a7972a95458f000000000e80000000020000200000005188120ac485f4e8a63e14df944242194f0edb31b58c7ab851697841a73a7f8b20000000587e1511e6ea906fca4145cbfd632b5b84a08009333d50ff6d73bde268bd59fa40000000652850a9d21da8091505ae7cc024f0d5a0f2f146a007a903bcb8c7d8c48e0a19e506f5e02811db254b91f99accc92d5a19f358248e98ba4a22e59c4653916cbf</SS>
    </Props>
  </Obj>
</Objs>
```
###### Decrypting PSCredential Object

- Importar archivo *.xml*:
```powershell
> $credential = Import-Clixml -Path C:\Path\To\Credentials.xml
```

- Extraer la contraseña y el usuario del objeto *PSCredential* importado:
```powershell
> $password = $credential.GetNetworkCredential().Password
> $username = $credential.UserName
> echo "$username::$password"
```