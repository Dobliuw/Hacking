# NetBIOS

**NetBIOS** (**Network Basic Input/Ouput System**) es una API que mejora las capacidades de comunicación en una LAN y permite a las aplicaciones en diferentes equipos comunicarse dentro de la misma red. Facilita la comunicación entre dispositivios y el manejo de transmisión de datos a través de la red.
###### Name Service (*NetBIOS-NS*):
Esta funcionalidad de NetBIOS es utilizada para identificar dispositiovs de red (Tiene hasta 15 caracteres), permite el registro y resolución de nombre de dispositivos, asegurando que cada dispositivo pueda ser identificado de forma única dentro de la red.

###### Datagram Distribution Service (*NetBIOS-DGM*):
Este serivicio maneja el envío de breves mensajes (*Datagrams*) a través de la network, a su vez, este es un servicio *connectionless*, es decir que no requiere de establecer una sesión previamente al envío de datos, similar a como funciona [[0. UDP]]. 

###### Session Service (*NetBIOS-SSN*):
Establece una conexión orientada a la comunicación entre dos dispositivos, este servicio maneja la creación, mantenimineot y finalización de una sesión, asegurando que los datos hayan sido transmitidos de manera confiable

Este protocolo suele usarse en algunos caso como:

- *Windows Networking*: NetBIOS a sido ampliamente utilizado en porotoclos de networking de Microsoft, especialmente en versiones antiguas de sistemas operativos Windows. Fue un componente fundamental en la suite de protocolos de red de Microsoft.
- *File and Printer Sharing*: NetBIOS permite compartir archivos e impresoras en un entorno de red, habilitando un fácil acceso y colaboración.
- *Legacy Systems*: Mientras las redes modernas hacen uso de protocolos más avanzados, NetBIOS sigue siendo relevante para mantener la compatibilidad con sistemas y software más antiguos.

**NetBIOS puede ser vulnerable** a varias amenazas de seguridad, como *name spoofing* y *unauthorized access*, debido a su naturaleza de transmisión y falta de cifrado.

---
# Enumeration

Para enumerar el protocolo *NetBIOS*, podremos seguir guías de enumeración conocidas com la de [HackTricks](https://book.hacktricks.xyz/network-services-pentesting/137-138-139-pentesting-netbios) u otras, en donde se nos indicará información relevante para llevar a cabo distintos ataques de ser posible o procesos de enumeración.

En este caso, referido a **NetBIOS-NS** (*137/udp*)...
```
PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
```
 Podremos hacer uso de herramientas como `nmblookup`, `nbtscan` y [[Nmap]]. 

- `nmblookup`
```bash
nmblookup -A {target_IP}
```

- `nbtscan`
```bash
nbtscan {IP}/{CIDR}
```

- [[Nmap]]
```bash
sudo nmap -sUV -T4 --script nbstat.nse -p{port/137} -Pn -n {target_IP}
```

En lo que a **NetBIOS-DGM** (*138/udp*) respecta...
```
PORT    STATE         SERVICE     VERSION
138/udp open|filtered netbios-dgm
```
Como vimos, permite la comunicación sin la necesidad de concretar una conexión, lo que lo vuelve menos útil para la enumeración o explotación, dado que la filtración de información no es muy poco probable ya que su uso es transmitir datos.

Por otro lado, en lo que a **NetBIOS-SSN** (*139/tcp*) respecta...
```
PORT      STATE SERVICE      VERSION
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
```
Como vimos, maneja una sesión orientada a la comunicación entre dos dispositivios, aunque puede ser utilizado para explotar vulnerabilidades en el protocolo *SMB* ([[Enum. SMB 445 - (Server Message Block)]]), que también utiliza el puerto 139, esto dado que suele verse bajo este puerto cuando se hace uso de *SMB over NetBIOS*, parte de la implementación de el viejo NetBIOS a través de la implementación TCP/IP, en cambio SMB en puerto 445 es utilizado directamente a través de TCP/IP sin la necesidad de NetBIOS (Implementación más moderna). Hoy en día la realidad es que las técnicas de pentesting actuales se centran directamente en este protocolo.