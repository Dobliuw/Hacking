# Git Dorking 

El **Git Dorking** es una técnica utilizada para buscar información sensible y repositorios de código fuente no protegidos que han sido expuestos públicamente en la plataforma de desarrollo de software Git, especialmente en el servicio Git más conocido, GitHub. Esta técnica se basa en el uso de búsquedas específicas en GitHub y otras plataformas de alojamiento de códgio para encontrar información y códgio fuente que normalmente debería ser de acceso público.
Algunas palabras claves son:

- **extension**: Este operador puede ser utilizado para buscar arachivos con extensiones escpecíficas en repositorios públicos.
- **filename**: Este operador busca archivos específicos en repositorios públicos.
- **language**: Busca repositorios escritos en un lenguaje de programación específico.
- **size**: Permite buscar repositorios por su tamaño en bytes.
- **in**: Este operador permite buscar contenido dentro de un archivo o repositorio.
- **path**: Este operador puede ser utilizado para buscar archivos o directorios específicos dentro de un repositorio público.
- **user**: Busca repositorios específicos creados por un usuario en particular.
- **org**: Similar a **user**, pero busca repositorios en una organización en lugar de en cuentas de usuarios individuales.
- **fork**: Busca repositorios que son bifurcaciones (Forks) de otros repositorios.

----
# Getting mail and full name from GitHub

Existe una posibilidad de obtener **nombre completo** y **corre electrónico** de un usuario desde *GitHub* a través de los commits, podemos hacer uso de los metadatos disponibles en los commits de Git. Esto se da dado que Git almacena información sobre el autor y el "commiter" (Persona que hace el comit) de cada cambio en un proyecto, y esta información está accesible públicamente en la mayoría de los repositirois de código abierto.

Normalmente la URL típica de un commit en GitHub tiene la sigueinte forma:

```bash
https://github.com/{username}/{repository}/commit/{commit_hash}
```

Al agregar `.patch` al final de estas URL de commits, GitHub mostrará el commit en un formato de texto plano que inlcuye en las primeras lineas los detalles y del autor y los cambios del commit:

Ejemplo:

- URL: `https://github.com/{username}/{repository}/commit/{commit_hash}.patch`
- Stdout:
```txt
From 7d1d1c4d35a40423bfc5ac9d5679e10f3b0d129e Mon Sep 17 00:00:00 2001
From: {Full Name} <{mail}@{domain}>
Date: Fri, 29 Sep 2023 10:35:04 -0300

Cambios en el archivo...
```

----
# GitHub REST API gathering information

La **REST API** de **GitHub** es una Application Programming Interface (API) que provee una interfaz programática para interactuar con las funcionalidades de GitHub mediante solicitudes HTTP estándar. Permite a los usuarios automatizar tareas, integrarse con GitHub y *recuperar datos detallados* sobre **repositorios**, **usuarios**, **issues**, **pull requets** y más.
###### Information leaked through GPG Keys

Una de los escenarios que se pueden encontrar en entornos reales, es cuando los usuarios que manejan claves GPG agregan sin darse cuenta fragmentos de comandos y/u outputs de estos, probablemente pegado por accidente en el cuerpo del bloque ASCII-armored durante el proceso de agregar la clave. Este *user input* extrapolado sería precisamente uno de los errores habituales de fuga información.

- [GitHub REST API for listing GPG Keys](https://docs.github.com/en/rest/users/gpg-keys?apiVersion=2022-11-28#list-gpg-keys-for-a-user):  
```bash
curl -L -H "Accept: application/vnd.github+json" \
-H "X-GitHub-Api-Version: 2022-11-28" \
https://api.github.com/users/{USERNAME}/gpg_keys
```

###### Information leaked through 90 day activity

GitHub mantiene una API pública con los eventos de actividad de un usuario, alojando actividad pública de organizaciones, repositorios y contribuidores (Así como más objetos) borrados, siempre y cuando haya ocurrido en los últimos 90 días, además estos están disponibles en una serie de endpoits de API denominadas *public events*. Esto es un dato a tener en mente muy importante dado que muchas veces en entornos reales puede haberse borrado un repositorio público que exponga credenciales pero en un tiempo menor a 90 días.

- [GitHub REST API for listing Public Events](https://docs.github.com/en/rest/activity/events?apiVersion=2022-11-28#list-public-events-for-a-user):
```bash
curl -L -H "Accept: application/vnd.github+json" \ 
-H "X-GitHub-Api-Version: 2022-11-28" \ 
https://api.github.com/users/{USERNAME}/events/public
```

###### Information leaked through Edited Comments

GitHub permite que los comentarios en commits o issues sean editados, si bien la API REST solo expondrá la versión final del comentario, puede ser un punto de interes a visitar para válidar si sufrió modificaciones. Para acceder a versiones anteriores se debe usar la UI de GitHub expandiendo la sección "Edited" y esto puede dar lugar a filtraciones de información, como credencialles, APIs, endpoints, detalles sensibles del código, etc.

- [GitHub REST API for Versionaning of Edited Comments](https://docs.github.com/en/rest/commits/comments?apiVersion=2022-11-28#list-commit-comments-for-a-repository):
```bash
curl -L -H "Accept: application/vnd.github+json" \
  -H "Authorization: Bearer <YOUR-TOKEN>" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  https://api.github.com/repos/{OWNER}/{REPO}/comments
```