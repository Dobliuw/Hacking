--------------------
- Tags: #teoria #practica #blue #analysis #malware
-----------
# Análisis de Malware

Una vez configurado nuestro [[Setup Analysis Enviroment]], podemos comenzar con el análisis de malware, pero primero, ¿Que es? El análisis de malware es el proceso de examinar el comportamiento y la estrucutra del software malicosos para comprender su funcionalidad, cómo actúa en un sistema y cómo se propaga. Esto permite desarrollar medidas para su detección, eliminación y prevención.

------
# Análisis Estático VS Análisis Dinámico

El **Análisis Estático** se enfoca en estudiar el malware sin ejecutarlo. Incluye la inspección de código, la estructura del archivo, metadatos y otras características sin avtivar su funcionamiento.

Por otro lado, el **Análisis Dinámico** implica ejecutar el malware en un entorno controaldo y observar su comportamiento en tiempo de ejecución.

-----
# Análisis Estático

Una de las primeras cosas que podemos hacer es *obtener hashes* (md5sum, sha256) para verificar posibles existencias de este malware, en caso de que estemos ante un malware potencialmente conocido, mediante la obtención de estos hashes podríamos verificar en herramientas como [VirusTotal](https://www.virustotal.com/gui/home/upload) u otras, la existencia y detección de motores de anti virus respecto a este hash.

Para obtener este hash podríamos hacer uso de los siguientes comandos de *PowerShell*:

```powershell
Get-FileHash {file_to_get_the_hash}
```
######  Strings & FLOSS

Las strings, como sabemos son un conjunto de caracteres los cuales usan los programadores para diversas funciones, como mensajes de texto en el programa, declaración de variables con urls, etc. Leer y hacer uso de esto puede ser super interesante de cara al análisis estática debido a que podemos llegar a obtener datos interesantes.

**Floss** es una herramienta que viene en *Flare-VM*, por lo que si configuramos nuestro entorno desde [[Setup Analysis Enviroment]] deberiamos contar con esta, por lo que podríamos abrir un **Cmder** (CMD con mayores capacidades) y hacer uso de esta herramienta para la lectura de strings de una muestra de malware:

```cmd
floss {file_to_get_the_strings}
```
###### Import Address Table

Como se menciono en [[Portable Executable - Formato PE]] el *Import Address Table* es una parte fundamental en la estrcutura de un archivio PE. Se utiliza en el contexto de los binarios compilados par sistemas operativos Windows. 

La **IAT** (**Import Address Table**) se encarga de contener las direcciones de memoria de las funciones y rutinas externas que un programa ejecutable necesita utilizar, pero que no se encuentran dentro del propio arhcivo ejecutable. Estas direcciones de memoria corresponden a las funciones y librerías de enlace dinámico (DLL) que son necesarias para que el programaa funcione correctamente. 



