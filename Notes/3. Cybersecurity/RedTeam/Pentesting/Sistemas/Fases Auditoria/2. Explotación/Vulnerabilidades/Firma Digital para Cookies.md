-----
- Tags: #teoria #practica #explotación 
-----
# Firma Digital de cookies

La firma digital de cookies es una técnica de seguridad que garantiza la integridad de los datos almacenados en las cookies. Cuando una cookie se firma digitalmente, se agrega una firma criptográfica a la cookie que se base en un secreto compartido entre el servidor y la aplicación. Esto permite al servidor verificar si la cookie ha sido manipulada por un tercero antes de procesarla. 

-------
# Explotación

Los casos de explotación de cookies que son digitalmente firmadas con un "secreto"(key) son varíos, pero uno muy común podría darse en aplicaciones de Express (Framework de Nodejs) en el cual se utilizan herramientas como [Cookie-monster](https://github.com/DigitalInterruption/cookie-monster) para obtener tanto una cookie de "**session**" como una cookie de "**session.sig**" la cual se encuentra firmada y el servidor la utiliza para verificar que la cookie "**session**" no haya sido alterada. 

Los ataques de cara a este escenario u otros son muy amplios, podría darse el caso de que se utilize un "secreto"(key) debil el cual puede ser probada por fuerza bruta sabiendo los datos de entradas para corroborar cual es la key utilizada, así como podría darse que contemos con un [[LFI - (Local File Inclusion)]] mediante el cual podramos llegar a leer código listando así el secreto.

Es importante recordar que podríamos visitar recursos como [HackTricks](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/nodejs-express) para ver más en profundidad este tipo de ataques.

