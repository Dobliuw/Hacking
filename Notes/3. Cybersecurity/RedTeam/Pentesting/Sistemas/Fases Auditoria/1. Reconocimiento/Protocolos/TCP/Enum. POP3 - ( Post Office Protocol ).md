-----
- Tags: #teoria #practica #recon 
-----
# POP

El Post Office Protocol, Protocolo de oficina de correo en español (**POP**) es un tipo de *red de computadoras* y *protocolo estandar de internet* que extrae y recupera correos electronicos desde un servidor remoto de mails para una máquina host. Es un protocolo de capa de aplicación que permite a los usuarios finales la capacidad de buscar y recibir correos electrónicos. 

-----
# Enumeración 

Para proceder con la enumeración, puede ser de vital importancia tener en mente los comandos más comunmente usados en POP:

```bash
USER uid Log in as "uid"
PASS password Substitue "password" for your actual password
STAT List number of messages, total mailbox size
LIST List messages and sizes
RETR n Show message n
DELE n Mark message n for deletion
RSET Undo any changes
QUIT Logout (expunges messages if no RSET)
TOP msg n Show first n lines of message number msg
CAPA Get capabilities
```

Los puertos por defecto en los que suele correr este protocolo es el puerto **110** y el puerto **995** (**ssl**).
###### Analizar certificado

Podemos inspeccionar el certificado ssl (En caso de que este este disponible en el puerto 995) haciendo uso de herramientas como **openssl**.

```bash
openssl s_client -connect {target_ip}:995 
```
###### Nmap

Teniendo en cuenta los comandos anteriormente mencionados, vimos que existe el comando `CAPA` el cual nos permite extraer y obtener las capabilities, lo cual puede resultar en información sensible. Para hacer uso de esto podemos lanzar un script de nmap encargado de intentar abusar de esto.

```bash
nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -p110 {target_ip}
```
###### Manual

También podemos hacer uso de herramientas como **NetCat** o **Telnet** para conectarnos de manera manual e intentar realizar diversas operaciones, desde inicio de sesion en caso de contar con credenciales, etc.

```bash
telnet {target_ip} 110
+OK beta POP3........
USER {username}
+OK
PASS {password}
+OK Welcome {username}

list

+OK 2 1807
1 786
2 1021

retr 1

+OK Message follows
From: ..............
```

De esta manera podríamos recuperar los correos alojados e inspeccionar manualmente cada uno de estos con el comando `LIST` para listar estos y el comando `RETR n` para recuperar y listar el contenido de determinado correo.
