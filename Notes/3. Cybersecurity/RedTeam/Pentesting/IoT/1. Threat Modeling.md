----
-  Tags: #pentesting #IoT  
----
Apuntes realizados a partir del libro "Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things"
# Internet of Things

El **Internet de las cosas** o **Internet of Things** describe objetos físicos con sensores, capacidad de procesamiento, software, etc que se conectan e intercambian datos con otros dispositivos y sistemas a través de internet u otras redes de comunicación.

Debido a que la seguridad de IoT se diferencia de la seguridad de TI tradiciional, los sistemas IoT también requieren diferentes técnicas. El ecosistema IoT suele estar compuesto por dispositivos y sensores integrados, dispositivos móviles, aplicaciones, infraestructura en la nube y protocolos de comunicación de red. Estos protocolos puede incluir aquellos en el stack de red TCP/IP como por ejemplo, mDNS, DNS-SD, UPnP, WS-Discovery, DICOM, también protocolos usados en rangos medios como Wi-Fi, Wi-Fi Direct, Zigbee, y de rango lejano como LoRa, LoRaWAN y Sigfox.

----
# Threat Modeling

Una de las formas más sencillas de comenzar a modelar la amenaza (Threat Modeling) respecto a la cibereseguridad, es seguir un *framework* como el modelo de clasificación de amenazas **STRIDE**, que se centra en identificar debilidades en la tencología en lugar de activos vulnerables o posibles atacantes.

El acrónimo representa las siguientes amenazas:

- **S***poofing***:  Cuando un atacante pretende desempeñar el papel de un componente del sistema.
- **T***ampering***: Cuando un atacante viola la integridad de los datos o de un sistema.
- **R***epudiation***: Cuando los usuarios pueden negar que realizaron ciertas acciones en el sistema.
- **I***nformation Disclosure***: Cuando un atacante viola la confidencialidad de los datos del sistema.
- **D***enial of Service***: Cuando un atacante puede interrumpir la disponibilidad de un sistema.
- **E***elevation of Privilege***: Cuando los usuarios o componentes del sistema puede elevar a un nivel de privilegio al que no deberían tener acceso.

*STRIDE* tiene tres pasos: 1. **Identificar la arquitectura**, 2. **dividirla en componentes** y 3. **identificar amenazas en cada componente**. 
###### Attack Trees

Para identificar nuevas amenazas de una manera diferente o mismo para modelar las ya identificadas con el framework STRIDE para un análisis más detallado, se puede hacer uso de los denominados **árbol de ataques** o **Attack Trees**. Un árbol de ataque es un mapa visual que comienza definiendo un objetivo de ataque genérico y luego se vuelve más específico a medida qeu el árbol se expande. Por ejemplo, en la imagen de abajo se muestra un árbol basado por amenazas de manipulación de la entrega de medicamentos (Usando el ejemplo del libro tratandose de un pump service - Pág. 19).
Los árboles de ataque pueden proporcionar una mayor comprensión del resultado de nuestro *threat modeling*, y podríamos descubrir amenazas que pasamos por alto antes. Observando la imagen, podemos ver que cada nodo contiene un posible ataque que requiere uno o más de los ataques descritos en los nodos secundarios. En algunos casos, el ataque puede requerir todos los nodos secundarios. Por ejemplo, la manipulación de los datos de la base de datos dentro de las bombas de infusión requiere que se obtenga acceso a la base de datos y la tenencia de controles de acceso inadecuados en las tablasd e la bibluioteca de medicamentos. Sin embargo, la entrega puede ser alterada cambiando la velocidad de infusión o interrumpiendo la actualización de la velocidad de infusión mediante un ataque DoS.

![[IoT_Attack_tree.png]]

----
# Amenazas comunes IoT

###### Signal Jamming Attacks
En un ataque de **interferencia de señal** o **Signal Jamming**, el atacante interfiere con la comunicación entre dos sistemas. Los sistemas de IoT suelen tener sus propios ecosistemas de nodos. Por ejemplo, el sistema de bomba de infusión de medicamentos tiene un servidor de control conectado a múltiples bombas de infusión de medicamentos. Con equipo especial, es posible aislar el servidor de control y las bombas entre sí. En sistmeas criticos como este, esta amenaza podría resultar fatal.

###### Replay Attacks
En un atauqe de **repetición** o **Replay**, el atacante repite alguna operación o reenvía un paquete transmitido. En el ejemplo de la bombna de infusión de medicamentos, esto podría significar que un paciente recibe múltiples dosis de un medicamento. repetir ataques, independientemente de que afecten o no a los dispositivos IoT, suelen ser graves.

###### Settings Tampering Attacks
En los ataques de **manipulación de entorno** o **settings tampering**, el atacante aprovecha la falta de seguridad de un componente para cambiar su configuracion. Para el ejemplo de la bomba de infusión de medicamentos, estas configuraciones podría incluir que se intercambie el servidor de control con un servidor de control malicioso controlado por el atacante, cambiar el fármaco principal utilizado o alterar la configuracion de la red para provocar un DoS.

###### Hardware Integrity Attacks
Los ataques a la **integridad del hardware** o **hardware integrity** comprometen la integridad de ldispositviod físico. Por ejemplo, un atacante podría eludir bloqueso inseguros o puertos USB de fácil acceso, especialmente si son de arranque. todos los sitemas de IoT enfrentan esta amenaza, porque ninguna portección de la integridad del dispositivo es perfecta. Aún así, ciertas técnicas lo hacen más dicícil.

###### Node Clonning
La clonacio´n de nodos es una maenaza que surge como parte de un ataque Sybil, en el que un atacante crea nodos falsos en una red para comprometer su confiabilidad. Los sistemas de IoT suele utilizar varios nodos en su ecosistema, como cuando un servidor de control gestiona varias bombas de infusión de medicamentos. A menudo encotramos amenzas de clonación de nodos en los sistemas de IoT. Una razón es qeu los protocolos de sasociación que utilizan los nodos para comunicarse no so muy sofisticados y, en ocasiones, crear nodos falsos puede resultar fácil. Ocasionalmente, incluso puedes crear un nodo maestro falso (Siguiendo el ejemplo de las bombas de infusión, el servidor de control). Esta amenaza podría afectar al sistema de vcarias maneras: ¿ Exisrte un número finitio de dnodos a lso que sepuede conectar un servidor de ctronol?, ¿ Puede esta amenaza dar lugar a un ataque de denación de serivico ?, ¿ üede hacer que los atcantes porpaguen información falsificada?. 

###### Security and Privacy Breaches
Las violaciones de la privacidad son una de las amenazas más grandes y consistentes en los sistemas IoT. A menudo, muy poco protege la confidencialidad de los datos del usuario, por lo que puede encontrar esta amenaza en casi cualquier protocolo de comunicación que transfiera datos hacia y desdfe un dispositivo.

###### User Security Awareness
Incluso si logra mitigar todas las demás amenazas, probablemente tendrá problemas para abordar la conciencia de seguridad de los usuarios. Esto podría incluir su capacidad para detectar correos electrónicos de phsihing, que podrían comprometer sus workstations, o su hábito de permitir el acceso a personas no autorizadas a áreas sensibles.