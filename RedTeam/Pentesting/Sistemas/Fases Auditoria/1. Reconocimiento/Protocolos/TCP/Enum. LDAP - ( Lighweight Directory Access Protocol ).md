-----
- Tags: #teoria #practica #recon 
-----
# Lighweight Directory Access Protocol 

### El protocolo LDAP o **protocolo ligero de acceso a directorios** es un protocolo a nivel de aplicación que permite el acceso a un servicio de directorio ordenado y distrubido para buscar diversa información en un entorno de red. 

-----
# Reconocimiento

### De cara a una auditoria de seguridad es muy importate la enumeración, y el protocolo **LDAP** puede ser una muy buena fuente de información, en caso de que podamos enumerarlo. 
#### Enumeración con ldapsearch
```shell
ldapsearch -H "ldap://{target_ip}" -x -s base namingcontexts
# Enumerar servicio ldap, en este caso, namingcontexts
ldapsearch -H "ldap://{target_ip}" -x -b {naming_context}
# Enumerar el servicio ldap
ldapsearch -H ldap://{target_ip}/ -x -D 'user@domain' -w 'password' -b "DC=subdomain,DC=tld"
# Corroborar credenciales validas
ldapsearch -H ldaps://{target_ip}/ -x -s base -b '' "(objectClass=*)" "*" +  
# Anonymous access
```
#### Enumeración con nmap 
```bash
nmap -n -sV --script "ldap* and not brute" -p 389 {target_ip}
```
#### Enumeración con ldapdomaindump
```bash
cd /var/www/html 
ldapdomaindump -u '{domain}\{username}' -p '{password}' {target_ip}
sudo systemctl start apache2 
```
### De esta manera, estamos volcando toda la información recopilada por la herramienta dentro de **/var/www/html** y al levantar el servicio de apache, si nos dirigimos al **localhost** tendremós  información en formato HTML.

### Adicionalmente, podemos encontrar más información sobre la enumeración del protoclo de **LDAP** en paǵinas como [hacktricks](https://book.hacktricks.xyz/network-services-pentesting/pentesting-ldap)

