----
- Tags: #ataques #basico #teoria #practica #recon
----
# Misconfigurations
### La **Misconfiguration** o **configuración defectuosa** se refiere a errores o cofniguraciones incorrectas en la forma en que una API está configurada o implementada. Estos errores pueden tener un impacto significativo en la seguridad, el rendimiento y la funcionalidad de una API.
### Algunos ejemplos comunes de estas **Misconfigurations** son el **acceso no autorizado**, la **exposición de datos sensibles**, **puertos abiertos y endpoints mal configurados**, la **autenticación débil o inexistente**, **límites de tasa intapropiados**, **logs inseguros**, **manejo de errores inseguros** o hasta **actualizaciones y parches desatendidos**, entre otras.

------
# Análisis de vulnerabilidades
### Una vez finalizada la fase de **reconocimiento** tanto [[Reconocimiento Pasivo]] como [[Reconocimiento Activo]], podemos proceder a realizar un análisis de vulnerabilidades básico. 
### Es importante tener en cuenta que una buena razón para realizar el testing es evitar que cualquier de los análisis a realizar activen un control de seguridad como un WAF que provoque el bloque de nuestro tráfico.
### En este punto, un análisis de vulnerabilidades nos ayudará a encontrar debilidades que podemos probar posteriormente para confirmar y expotar. Hay que tener en cuenta que rara vez estos análisis automatizados son 100% precisos así como rara vez detectan todas las vulnerabilidades, por lo tanto este proceso será utilizado para ayudar a guiar y enfocar el testing.
### Muchas veces las empresas utilizan escaners automatizados que no fueron diseñados en principio para APIs los cuales generan falsos resultados 'negativos' ya que no enumeran vulnerabilidades generando así para las empresas una falsa sensación se seguridad, esto se da ya que no se detectan muchas de las vulnerabilidades enumeradas en [[OWASP Top 10 API]]. Aunque estos escaners si cumplen una buena función tratadose de el descubrimiento de la vulnerabilidad **API8 2023 (Security Missconfiguration)**.

## Escaneo automatizado
### Como bien dijimos, podemos hacer uso de herramientas automatizadas como **nikto** o **OWASP Zap**, las cuales tal vez nos devuelvan posibles vulnerabilidades en donde con suerte pueden ser correctas, en otros casos no, por otro lado puede devolver tanto falsos negativos como nada de información, pero igualmente en caso de querer corroborar estas podríamos realizarlo se la siguiente manera.
#### Nikto
```bash
nikto -h {url}
```
### Esta herramienta buscara por vulnerabilidades conocidas en el host indicado.

#### OWASP Zap
```bash
zaproxy
```
### Con este comando iniciamos la herramienta, y cuando se nos abre la GUI podemos indicar realizar un escaneo automatizado.

![[automated_scan_owap_zap.png]]
## Escaneo manual
### Luego de probar estas herramientas en caso de así desearlo, muy probablemente nos encontremos con poca información referida acerca de errores o vulnerabilidades en lo que a la API respecta, por lo que nos será mucho más conveniente hacer uso de por ejemplo **OWASP Zap** para realizar esta fase de análisis de vulnerabilidades de manera manual, de esta manera haciendo uso de la evidencia capturada en la fase de [[Reverse Engineering an API]] podríamos subir a esta herramienta el archivo **.yml**.

![[import_openapi_definition_zap.png]]
### Nos dirigimos a **Import** > **Import an OpenAPI definition from the local file system** > Indicamos el path del **.yml** e indicamos la url de nuestro target.
### O también podríamos selección la opción de **Manual Explore**.

![[manual_explore_zap.png]]
### Luego de indicar la url, si presionamos **Launch Browser** podremos navegar en la web indicando con las opciones de los costado **Attack Mode On**, y comenzar a navegar toda la web con un uso normal, una vez finalizada esta navegación, podemos volver a la herramienta **Zap** en donde veremos muchos servidores capturados durante la navegación, como puede ser google, fonts, etc.
### Por lo que nos dirigimos a la carpeta de nuestra sitio web target, y presionamos la opción de **Include in Context**.

![[include_in_context_zap.png]]
### Una vez realizado esto, en el apartado de **Alerts** podremos ver todas las posibles vulnerabilidades detectadas y comenzar a descartar falsos negativos.

![[alerts_zap.png]]